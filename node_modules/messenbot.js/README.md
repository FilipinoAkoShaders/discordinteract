## MessenBot


> Create Messenger Bot in Minutes


## Note

- This uses Facebook graph api
- This is not 100% success its still in test
- This only needs "PAGE_ID", "ACCESS_TOKEN" and "WEBHOOK_VERIFY_TOKEN"

## Log
- Fixed "Request Aborted", Request Aborted Error is causing a long pending promise

## Documentation

1. Create new Application
   - Event (verified) is fired when the bot is ready to recieve messages
   - Event (ready) is fired when the server is up
   - Event (message) is fired when theres a new message
     - Returns (event)
   - Event (postback) is fired when theres a post back (Not Tested Yet!)
   - Event (error) is fired when theres a new error recieved
3. Create a message callback
   - Event (message)
     - Returns (event)
4. Send Message
   - from (event.sendMessage) in event (message) and (postback)
     - param {message} (string)
5. Send Action
   - from (event.sendAction) in event (message) and (postback)
     - param {action} (string)
6. Send File/Attachment
   - from (event.sendFile) in event (message) and (postback)
     - param {filepath} (string) - path of the file
     - param {filetype} (string) - can be (image), (video), (audio), and, (file)
7. Done of application


==============


1. Create new Application


```js
const MessenBot = require('messenbot.js')

let client = new MessenBot.Bot({
        accessToken: "Your bots page access token",
        verifyToken: "Your bots webhook verify token",
        pageId: "Your bots page id"
})

client.login() // Login to the page account
// also verifying the token

client.on('verified', () => {
        console.log('bot is verified')
})

client.on('ready', () => {
        console.log('server is up')
})
```


2. Message callback


```js
client.on('message', async(event) => {
        console.log('New message: '+JSON.stringify(event))
})
```


3. Postback callback


```js
client.on('postback', async(event) => {
        console.log('New postback: '+JSON.stringify(event))
})
```

4. Send message


```js
await event.sendMessage('hello world') // limit is 2000 characters
```


5. Send action


```js
await event.sendAction('mask_seen')
```


Actions:
- "mask_seen": make the bot seen the message
- "typing_on": make the bot in typing state (lasts 20 seconds or if bot send a message)
- "typing_off": make the bot remove the typing state


6. Send File/Attachment


```js
await event.sendFile('./myimg.png', 'image')
await event.sendFile('./myvid.mp4', 'video')
await event.sendFile('./myaudio.mp4', 'audio')
await event.sendFile('./myrandomfile.txt', 'file')
```


7. Done of application


Full code


```js
const MessenBot = require('messenbot.js')

let client = new MessenBot.Bot({
        accessToken: "Your bots page access token",
        verifyToken: "Your bots webhook verify token",
        pageId: "Your bots page id"
})

client.login() // Login to the page account
// also verifying the token

client.on('verified', () => {
        console.log('bot is verified')
})

client.on('ready', () => {
        console.log('server is up')
})

client.on('message', async(event) => {
        console.log('New message: '+JSON.stringify(event))

        await event.sendAction('typing_on')

        await event.sendMessage('hello world') // limit is 2000 characters

        await event.sendAction('typing_on')
        
        await event.sendFile('./myaudio.mp4', 'audio')
})

client.on('postback', async(event) => {
        console.log('New postback: '+JSON.stringify(event))
})
```


Now you have a full setup of your messenger bot!!


## Done!!


Get the example


1. "git clone https://github.com/FilipinoAkoShaders/messenbot-example.git"
2. "cd messenbot-example"
3. "npm install"
4. "npm start"